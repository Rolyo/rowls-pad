<!DOCTYPE html>
<html lang="en">
<head>
<meta name="mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-capable" content="yes">
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#111">
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Rowls Mobile Pad</title>
<style>
* { box-sizing: border-box; margin:0; padding:0; }

body {
  font-family: system-ui, sans-serif;
  background: url('images/aa.jpg') no-repeat center center fixed;
  background-size:cover;
  color:#fff;
  display:flex;
  flex-direction:column;
  min-height:100vh;
}

/* SPLASH */
#splash {
  position: fixed;
  inset: 0;
  background: #111;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  z-index: 9999;
  color: #fff;
}
#splash img {
  width: 90vw;
  max-width: 300px;
  height: auto;
  margin-bottom: 50px;
  transform: scale(0.6);
  animation: splashZoom 1.2s ease-out forwards;
}
#splash-text {
  font-family: system-ui, sans-serif;
  font-size: 2rem;
  font-weight: bold;
  text-align: center;
  opacity: 0;
  animation: fadeInText 1s forwards .5s;
  margin-top: 10px;
}
@keyframes splashZoom { 0% { transform: scale(0.6); } 100% { transform: scale(1.2); } }
@keyframes fadeInText { to { opacity: 1; } }

/* PADS */
.pad-grid {
  display:grid;
  grid-template-columns: repeat(4, 1fr);
  grid-auto-rows: 65px;
  gap:5px;
  width:100%;
  max-width:420px;
  margin-bottom:20px;
  margin-top: 5px;
}
.pad {
  display:flex;
  justify-content:center;
  align-items:center;
  border-radius:14px;
  font-size:32px;
  cursor:pointer;
  user-select:none;
  transition: transform 0.1s, box-shadow 0.2s, filter 0.1s;
  color:#fff;
}
.pad:active {
  transform: scale(0.95);
  filter: brightness(1.3);
  box-shadow: 0 0 20px #fff;
}
.pad.active { animation: glow 0.5s ease-in-out infinite, padPulse 0.5s alternate infinite; }
.pad.flash { animation: flash 0.15s forwards; }
@keyframes glow { 0%,100%{ box-shadow:0 0 12px #fff; } 50%{ box-shadow:0 0 24px #fff; } }
@keyframes padPulse { 0%{transform:scale(1);}50%{transform:scale(1.1);}100%{transform:scale(1);} }
@keyframes flash { 0%{filter:brightness(1);}50%{filter:brightness(2);}100%{filter:brightness(1);} }

.pad.color1 { background:#ff6b6b; }
.pad.color2 { background:#ffb347; }
.pad.color3 { background:#6bffb3; }
.pad.color4 { background:#6bafff; }
.pad.color5 { background:#d46bff; }
.pad.color6 { background:#ff6bda; }



/* MUSIC BAR */
.music-bar {
  display:grid;
  grid-template-columns: repeat(4, 1fr);
  grid-auto-rows: 65px;
  gap:5px;
  width:100%;
  max-width:400px;
  margin:0 auto 14px auto;
}

.music-bar button {
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  border-radius: 12px;
  cursor: pointer;
  user-select: none;
  color: #fff;
  width: 100%;      /* force fixed button width */
  height: 65px;
  padding: 4px;
  overflow: hidden;  /* important: hide overflowing text */
  position: relative;
}
.music-bar button.active { animation: glow 0.5s ease-in-out infinite, padPulse 0.5s alternate infinite; transform: scale(1.05); }

.music-bar button span.title {
  display: block;
  width: 100%;
  overflow: hidden;       
  white-space: nowrap;
  text-align: center;
  position: relative;
}

.music-bar button span.title span.inner-title {
  display: inline-block;
  padding-left: 0;
  /* REMOVE the 100% padding */
  will-change: transform;
}

@keyframes scrollTitle {
  0% { transform: translateX(0); }
  100% { transform: translateX(-100%); }
}


.music-bar button.color1 { background:#ff6b6b; }
.music-bar button.color2 { background:#ffb347; }
.music-bar button.color3 { background:#6bffb3; }
.music-bar button.color4 { background:#6bafff; }
.music-bar button.color5 { background:#d46bff; }
.music-bar button.color6 { background:#ff6bda; }

/* LONG MUSIC */
.long-music-container { width:100%; display:flex; flex-direction:column; align-items:center; margin-bottom:12px; }
.long-music { width:100%; max-width:325px; height:50px; border-radius:12px; background:#6bafff; display:flex; align-items:center; justify-content:center; font-size:28px; cursor:pointer; color:#fff; position:relative; transition: transform 0.1s, box-shadow 0.2s; }
.long-music.active { animation: glow 0.5s ease-in-out infinite, padPulse 0.5s alternate infinite; transform: scale(1.0); }
.long-music.flash { animation: flash 0.15s forwards; }
.long-music .title { font-size:13px; display:block; max-width:250px; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; text-align:center; pointer-events:none; }

#volumeControl { width:80%; margin-top:10px; height:8px; border-radius:3px; cursor:pointer; background: rgba(255,255,255,0.3); -webkit-appearance:none; }
#volumeControl::-webkit-slider-thumb { -webkit-appearance:none; height:14px; width:14px; border-radius:50%; background:#fff; cursor:pointer; margin-top:0px; }
#volumeControl::-moz-range-thumb { height:14px; width:14px; border-radius:50%; background:#fff; cursor:pointer; }

/* CONTROLS */
.control-bar { display:flex; gap:5px; margin-bottom:12px; justify-content:center; }
.control-bar button { padding:7px 12px; border-radius:12px; border:none; cursor:pointer; background:rgba(255,255,255,0.56); color:#111; font-weight:bold; }
.control-bar button:hover { background: lightskyblue; }

/* CATEGORIES */
.category-bar {
  display: flex;
  gap: 3px;
  flex-wrap: wrap;
  justify-content: center;
  margin-top: 8px;
}

.category-bar button {
  padding: 7px 12px;
  border-radius: 20px;
  border: none;
  font-size: 13px;
  cursor: pointer;
  font-weight: bold;
  background: rgba(255, 255, 255, 0.75);
  color: #000;
  /* BLACK FONT */
  transition: transform 0.15s, box-shadow 0.2s, background 0.2s;
}

/* HOVER EFFECT */
.category-bar button:hover {
  background: #fff;
  box-shadow: 0 0 8px rgba(0, 0, 0, 0.4);
  transform: scale(1.05);
}

/* ACTIVE (SELECTED CATEGORY) */
.category-bar button.active {
  background: lightskyblue;
  color: #000;
  box-shadow: 0 0 12px rgba(0, 0, 0, 0.6);
  transform: scale(1.1);
}

/* UPLOAD */
.upload-input { display:none; }

/* MAIN CONTAINER (for landscape layout) */
.main-container { display:flex; flex-direction:column; flex:1; gap:10px; }

/* LANDSCAPE-ONLY LAYOUT */
@media (orientation: landscape) {
  .main-container { flex-direction:row; gap:10px; padding:10px; flex:1; }

  .pad-grid { flex:1; grid-template-columns: repeat(4, 1fr); grid-auto-rows:1fr; gap:5px; }
  .music-bar { flex:1; grid-template-columns: repeat(2, 1fr); grid-auto-rows:1fr; gap:3px; }

  .bottom-bar { display:flex; flex-direction:column; gap:6px; padding:10px; }

  .long-music-container, .control-bar, .category-bar { width:100%; justify-content:center; }
  .long-music { width:90%; max-width:none; }
  #volumeControl { width:90%; max-width:none; }
}
</style>
</head>
<body>

<div id="splash">
  <img src="icons/icon2.png" alt="ROWLS MOBILE PAD">
  <div id="splash-text">ROWLS MOBILE PAD</div>
</div>

<!-- MAIN CONTAINER -->
<div class="main-container">

  <!-- PAD GRID LEFT -->
  <div class="pad-grid" id="padGrid">
    <div class="pad color1" data-audio="sounds/ TOINK .mp3">ü•Å</div>
    <div class="pad color2" data-audio="sounds/JOKING.wav">üòÇ</div>
    <div class="pad color3" data-audio="sounds/YAHOOO.wav">ü§†</div>
    <div class="pad color4" data-audio="sounds/WIIY.wav">üí£</div>
    <div class="pad color5" data-audio="sounds/CHIPMUNK LAUGH.mp3">üé≤</div>
    <div class="pad color6" data-audio="sounds/EAT BULAGA.wav">‚ùå</div>
    <div class="pad color1" data-audio="sounds/CROWD CLAP.wav">ü•Å</div>
    <div class="pad color2" data-audio="sounds/CROWD LAUGH.wav">üëü</div>
    <div class="pad color3" data-audio="sounds/WOOW.mp3">üîî</div>
    <div class="pad color2" data-audio="sounds/AWW.wav">‚òï</div>
    <div class="pad color5" data-audio="sounds/LOSER.wav">üê∂</div>
    <div class="pad color6" data-audio="sounds/SAD.mp3">ü§†</div>
    <div class="pad color1" data-audio="sounds/HORN 3.wav">ü§†</div>
    <div class="pad color6" data-audio="sounds/BROKEN GLASS.wav">ü§†</div>
    <div class="pad color3" data-audio="sounds/DRUM ROLL.mp3">üòÇ</div>
    <div class="pad color4" data-audio="sounds/DRUM HI-HAT.mp3">ü§†</div>
    <div class="pad color1" data-audio="sounds/EASY.wav">ü§†</div>
    <div class="pad color6" data-audio="sounds/ FAST RUN.mp3">ü§†</div>
    <div class="pad color3" data-audio="sounds/TUBO.wav">ü§†</div>
    <div class="pad color2" data-audio="sounds/AMAZING.wav">ü§†</div>
  </div>

  <!-- MUSIC GRID RIGHT -->
  <div class="music-bar" id="musicBar"></div>
</div>

<!-- BOTTOM CONTROLS -->
<div class="bottom-bar">
  <div class="long-music-container">
    <div class="long-music" id="longMusic">
      <span class="title">Background Music</span>
    </div>
    <input type="range" id="volumeControl" min="0" max="1" step="0.01" value="0.5">
  </div>

  <div class="control-bar">
    <button id="clearPads">Clear Pads</button>
    <button id="reloadPads">Reload Pads</button>
    <button id="togglePads">Hide Pads</button>
  </div>

  <div class="category-bar">
    <button data-category="specialPads">Home</button>
    <button data-category="wedding">Wedding</button>
    <button data-category="birthday">Birthday</button>
    <button data-category="party">Party</button>
    <button data-category="love">Love/Sad</button>
    <button data-category="RetroDance">RetroDance</button>
    <button data-category="Balse">Balse</button>
    <button data-category="Dinner">Dinner</button>
    <button data-category="awarding">Awarding</button>
  </div>
</div>

<input type="file" accept="audio/*" id="uploadAudio" class="upload-input">

<script>


// --- PADS ---
const pads = document.querySelectorAll('.pad');
const padAudios = new Map();
pads.forEach(pad => {
  const audio = new Audio(pad.dataset.audio);
  audio.preload = 'auto';
  padAudios.set(pad, audio);

  const startPlay = () => {
    audio.currentTime = 0;
    audio.play();
    pad.classList.add('active');
    pad.classList.add('flash');
    setTimeout(()=>pad.classList.remove('flash'),150);
  };
  const stopPlay = () => {
    audio.pause();
    audio.currentTime = 0;
    pad.classList.remove('active');
  };

  pad.addEventListener('touchstart', startPlay);
  pad.addEventListener('mousedown', startPlay);
  pad.addEventListener('touchend', stopPlay);
  pad.addEventListener('mouseup', stopPlay);
  pad.addEventListener('mouseleave', stopPlay);
  
});
// SET PAD TITLES FROM DEFAULT AUDIO FILENAMES
pads.forEach(pad => {
  const src = pad.dataset.audio;
  if (!src) return;

  let name = src.split('/').pop();      // get filename
  name = name.replace(/\.[^/.]+$/, ''); // remove extension

  pad.textContent = name;
  pad.style.fontSize = "15px";
  pad.style.textAlign = "center";
  pad.style.padding = "4px";
});


// --- MUSIC DATA ---
const musicData = {
  wedding:[
  { file: 'Wedding1', title: 'Wedding1' },
  { file: 'Wedding2', title: 'EMPTY' },
  { file: 'Wedding3', title: 'EMPTY' },
  { file: 'Wedding4', title: 'EMPTY' },
  { file: 'Wedding5', title: 'EMPTY' },
  { file: 'Wedding6', title: 'EMPTY' },
  { file: 'Wedding7', title: 'EMPTY' },
  { file: 'Wedding8', title: 'EMPTY' },
  { file: 'Wedding9', title: 'EMPTY' },
  { file: 'Wedding10', title: 'EMPTY' },
  { file: 'Wedding11', title: 'EMPTY' },
  { file: 'Wedding12', title: 'EMPTY' }
],
  birthday: [
  { file: 'special1', title: 'Birthday1' },
  { file: 'special2', title: 'EMPTY' },
  { file: 'special3', title: 'EMPTY' },
  { file: 'special4', title: 'EMPTY' },
  { file: 'special5', title: 'EMPTY' },
  { file: 'special6', title: 'EMPTY' },
  { file: 'special7', title: 'EMPTY' },
  { file: 'special8', title: 'EMPTY' },
  { file: 'special9', title: 'EMPTY ' },
  { file: 'special10', title: 'EMPTY' },
  { file: 'special11', title: 'EMPTY' },
  { file: 'special12', title: 'EMPTY' }
],
  party: [
  { file: 'special1', title: 'party1' },
  { file: 'special2', title: 'EMPTY' },
  { file: 'special3', title: 'EMPTY' },
  { file: 'special4', title: 'EMPTY' },
  { file: 'special5', title: 'EMPTY' },
  { file: 'special6', title: 'EMPTY' },
  { file: 'special7', title: 'EMPTY' },
  { file: 'special8', title: 'EMPTY' },
  { file: 'special9', title: 'EMPTY' },
  { file: 'special10', title: 'EMPTY' },
  { file: 'special11', title: 'EMPTY' },
  { file: 'special12', title: 'EMPTY' }
],
  love: [
  { file: 'special1', title: 'love1' },
  { file: 'special2', title: 'EMPTY' },
  { file: 'special3', title: 'EMPTY' },
  { file: 'special4', title: 'EMPTY' },
  { file: 'special5', title: 'EMPTY' },
  { file: 'special6', title: 'EMPTY' },
  { file: 'special7', title: 'EMPTY' },
  { file: 'special8', title: 'EMPTY' },
  { file: 'special9', title: 'EMPTY' },
  { file: 'special10', title: 'EMPTY' },
  { file: 'special11', title: 'EMPTY' },
  { file: 'special12', title: 'EMPTY' }
],
  RetroDance: [
  { file: 'RETRO1', title: 'DANCING QUEEN' },
  { file: 'special2', title: 'EMPTY' },
  { file: 'special3', title: 'EMPTY' },
  { file: 'special4', title: 'EMPTY' },
  { file: 'special5', title: 'EMPTY' },
  { file: 'special6', title: 'EMPTY' },
  { file: 'special7', title: 'EMPTY' },
  { file: 'special8', title: 'EMPTY' },
  { file: 'special9', title: 'EMPTY' },
  { file: 'special10', title: 'EMPTY' },
  { file: 'special11', title: 'EMPTY' },
  { file: 'special12', title: 'EMPTY' }
],
  Balse: [
  { file: 'special1', title: 'Tiktok1' },
  { file: 'special2', title: 'EMPTY' },
  { file: 'special3', title: 'EMPTY' },
  { file: 'special4', title: 'EMPTY' },
  { file: 'special5', title: 'EMPTY' },
  { file: 'special6', title: 'EMPTY' },
  { file: 'special7', title: 'EMPTY' },
  { file: 'special8', title: 'EMPTY' },
  { file: 'special9', title: 'EMPTY' },
  { file: 'special10', title: 'EMPTY' },
  { file: 'special11', title: 'EMPTY' },
  { file: 'special12', title: 'EMPTY' }
],
  Dinner: [
  { file: 'special1', title: 'Fashion1' },
  { file: 'special2', title: 'EMPTY' },
  { file: 'special3', title: 'EMPTY' },
  { file: 'special4', title: 'EMPTY' },
  { file: 'special5', title: 'EMPTY' },
  { file: 'special6', title: 'EMPTY' },
  { file: 'special7', title: 'EMPTY' },
  { file: 'special8', title: 'EMPTY' },
  { file: 'special9', title: 'EMPTY' },
  { file: 'special10', title: 'EMPTY' },
  { file: 'special11', title: 'EMPTY' },
  { file: 'special12', title: 'EMPTY' }
],
  awarding: [
  { file: 'special1', title: 'Awarding1' },
  { file: 'special2', title: 'EMPTY' },
  { file: 'special3', title: 'EMPTY' },
  { file: 'special4', title: 'EMPTY' },
  { file: 'special5', title: 'EMPTY' },
  { file: 'special6', title: 'EMPTY' },
  { file: 'special7', title: 'EMPTY' },
  { file: 'special8', title: 'EMPTY' },
  { file: 'special9', title: 'EMPTY' },
  { file: 'special10', title: 'EMPTY' },
  { file: 'special11', title: 'EMPTY' },
  { file: 'special12', title: 'EMPTY' }
  
],
  specialPads: [
    { file: 'special1', title: 'Special' },
    { file: 'special2', title: 'EMPTY' },
    { file: 'special3', title: 'EMPTY' },
    { file: 'special4', title: 'EMPTY' },
    { file: 'special5', title: 'EMPTY' },
    { file: 'special6', title: 'EMPTY' },
    { file: 'special7', title: 'EMPTY' },
    { file: 'special8', title: 'EMPTY' },
    { file: 'special9', title: 'EMPTY' },
    { file: 'special10', title: 'EMPTY' },
    { file: 'special11', title: 'EMPTY' },
    { file: 'special12', title: 'EMPTY' }
    
  ]
};

const hiddenMusicData = {
  wedding: [
    { file: 'H-WED1', title: 'EMPTY' },
    { file: 'H-Wedding2', title: 'Special 2' },
    { file: 'H-Wedding3', title: 'Special 3' },
    { file: 'H-Wedding4', title: 'Special 4' },
    { file: 'H-Wedding5', title: 'Special 5' },
    { file: 'H-Wedding6', title: 'Special 6' },
    { file: 'H-Wedding7', title: 'Special 7' },
    { file: 'H-Wedding8', title: 'Special 8' },
    { file: 'H-Wedding9', title: 'Special 9' },
    { file: 'H-Wedding10', title: 'Special 10' },
    { file: 'H-Wedding11', title: 'Special 11' },
    { file: 'H-Wedding12', title: 'Special 12' }
  ],
  birthday: [
    { file: 'special1', title: 'Birthday1' },
    { file: 'special2', title: 'Special 2' },
    { file: 'special3', title: 'Special 3' },
    { file: 'special4', title: 'Special 4' },
    { file: 'special5', title: 'Special 5' },
    { file: 'special6', title: 'Special 6' },
    { file: 'special7', title: 'Special 7' },
    { file: 'special8', title: 'Special 8' },
    { file: 'special9', title: 'Special 9' },
    { file: 'special10', title: 'Special 10' },
    { file: 'special11', title: 'Special 11' },
    { file: 'special12', title: 'Special 12' }
  ],
  party: [
    { file: 'special1', title: 'party1' },
    { file: 'special2', title: 'Special 2' },
    { file: 'special3', title: 'Special 3' },
    { file: 'special4', title: 'Special 4' },
    { file: 'special5', title: 'Special 5' },
    { file: 'special6', title: 'Special 6' },
    { file: 'special7', title: 'Special 7' },
    { file: 'special8', title: 'Special 8' },
    { file: 'special9', title: 'Special 9' },
    { file: 'special10', title: 'Special 10' },
    { file: 'special11', title: 'Special 11' },
    { file: 'special12', title: 'Special 12' }
  ],
  love: [
    { file: 'special1', title: 'love1' },
    { file: 'special2', title: 'Special 2' },
    { file: 'special3', title: 'Special 3' },
    { file: 'special4', title: 'Special 4' },
    { file: 'special5', title: 'Special 5' },
    { file: 'special6', title: 'Special 6' },
    { file: 'special7', title: 'Special 7' },
    { file: 'special8', title: 'Special 8' },
    { file: 'special9', title: 'Special 9' },
    { file: 'special10', title: 'Special 10' },
    { file: 'special11', title: 'Special 11' },
    { file: 'special12', title: 'Special 12' }
  ],
  RetroDance: [
    { file: 'special1', title: 'Fun1' },
    { file: 'special2', title: 'Special 2' },
    { file: 'special3', title: 'Special 3' },
    { file: 'special4', title: 'Special 4' },
    { file: 'special5', title: 'Special 5' },
    { file: 'special6', title: 'Special 6' },
    { file: 'special7', title: 'Special 7' },
    { file: 'special8', title: 'Special 8' },
    { file: 'special9', title: 'Special 9' },
    { file: 'special10', title: 'Special 10' },
    { file: 'special11', title: 'Special 11' },
    { file: 'special12', title: 'Special 12' }
  ],
  Balse: [
    { file: 'special1', title: 'Tiktok1' },
    { file: 'special2', title: 'Special 2' },
    { file: 'special3', title: 'Special 3' },
    { file: 'special4', title: 'Special 4' },
    { file: 'special5', title: 'Special 5' },
    { file: 'special6', title: 'Special 6' },
    { file: 'special7', title: 'Special 7' },
    { file: 'special8', title: 'Special 8' },
    { file: 'special9', title: 'Special 9' },
    { file: 'special10', title: 'Special 10' },
    { file: 'special11', title: 'Special 11' },
    { file: 'special12', title: 'Special 12' }
  ],
  Dinner: [
    { file: 'special1', title: 'Fashion1' },
    { file: 'special2', title: 'Special 2' },
    { file: 'special3', title: 'Special 3' },
    { file: 'special4', title: 'Special 4' },
    { file: 'special5', title: 'Special 5' },
    { file: 'special6', title: 'Special 6' },
    { file: 'special7', title: 'Special 7' },
    { file: 'special8', title: 'Special 8' },
    { file: 'special9', title: 'Special 9' },
    { file: 'special10', title: 'Special 10' },
    { file: 'special11', title: 'Special 11' },
    { file: 'special12', title: 'Special 12' }
  ],
  awarding: [
    { file: 'special1', title: 'Awarding1' },
    { file: 'special2', title: 'Special 2' },
    { file: 'special3', title: 'Special 3' },
    { file: 'special4', title: 'Special 4' },
    { file: 'special5', title: 'Special 5' },
    { file: 'special6', title: 'Special 6' },
    { file: 'special7', title: 'Special 7' },
    { file: 'special8', title: 'Special 8' },
    { file: 'special9', title: 'Special 9' },
    { file: 'special10', title: 'Special 10' },
    { file: 'special11', title: 'Special 11' },
    { file: 'special12', title: 'Special 12' }
    
  ],
  specialPads: [
    { file: 'special1', title: 'hahaha' },
    { file: 'special2', title: 'Special 2' },
    { file: 'special3', title: 'Special 3' },
    { file: 'special4', title: 'Special 4' },
    { file: 'special5', title: 'Special 5' },
    { file: 'special6', title: 'Special 6' },
    { file: 'special7', title: 'Special 7' },
    { file: 'special8', title: 'Special 8' },
    { file: 'special9', title: 'Special 9' },
    { file: 'special10', title: 'Special 10' },
    { file: 'special11', title: 'Special 11' },
    { file: 'special12', title: 'Special 12' }
    
  ]
};



const musicBar = document.getElementById('musicBar');
const uploadInput = document.getElementById('uploadAudio');
let currentCategory = 'specialPads'; 
const categoryAudios = {};

Object.keys(musicData).forEach(cat => {
  categoryAudios[cat] = musicData[cat].map(item=>({
    name:item.file,
    defaultSrc:`sounds/${item.file}.mp3`,
    defaultTitle:item.title,
    audio:new Audio(`sounds/${item.file}.mp3`),
    button:null,
    title:item.title
  }));
});

// LOAD MUSIC BUTTONS
function loadMusicButtons(category){
  currentCategory = category;
  musicBar.innerHTML = '';
  const audios = categoryAudios[category];
  if(!audios) return;

  audios.forEach((item,index)=>{
    const btn = document.createElement('button');
    btn.className = `color${(index%6)+1}`;
    item.button = btn;

    // ALWAYS use inner-title for scrolling
    const titleSpan = document.createElement('span');
    titleSpan.className='title';

    const inner = document.createElement('span');
    inner.className = 'inner-title';
    inner.textContent = item.title;

    titleSpan.appendChild(inner);
    btn.appendChild(titleSpan);
    
// SCROLLING LOGIC
setTimeout(() => {
  if(inner.scrollWidth <= titleSpan.clientWidth){
    inner.style.animation = 'none';  // short titles ‚Üí no scroll
  } else {
    inner.style.animation = 'scrollTitle 6s linear infinite'; // long titles ‚Üí scroll
  }
}, 50); // 50ms delay is usually enough




    // Check if text overflows ‚Üí scroll
    requestAnimationFrame(() => {
      if(inner.offsetWidth <= titleSpan.offsetWidth){
        inner.style.animation = 'none';
      } else {
        inner.style.animation = 'scrollTitle 6s linear infinite';
      }
    });

    // CLICK PLAY / PAUSE
    btn.addEventListener('click', ()=>{
      audios.forEach(a=>{
        if(a.audio !== item.audio){
          a.audio.pause();
          a.button?.classList.remove('active');
        }
      });

      if(item.audio.paused){
        item.audio.play();
        btn.classList.add('active');
      } else {
        item.audio.pause();
        btn.classList.remove('active');
      }

      btn.classList.add('flash');
      setTimeout(()=>btn.classList.remove('flash'),150);
    });

    // DOUBLE CLICK UPLOAD
    btn.addEventListener('dblclick', ()=>{
      uploadInput.value = "";
      uploadInput.click();

      uploadInput.onchange = ()=>{
        const file = uploadInput.files[0];
        if(file){
          item.audio.src = URL.createObjectURL(file);
          item.title = file.name;
          inner.textContent = file.name;

          requestAnimationFrame(() => {
            if(inner.offsetWidth <= titleSpan.offsetWidth){
              inner.style.animation = 'none';
            } else {
              inner.style.animation = 'scrollTitle 6s linear infinite';
            }
          });
        }
      };
    });

    musicBar.appendChild(btn);
  });
}

// ASSIGN PADS TO CATEGORY
function assignPadsToCategory(category){
  const padsArr = Array.from(pads);
  const audios = [...(categoryAudios[category] || [])];
  padsArr.forEach((pad,i)=>{
    if(audios.length===0) return;
    const item = audios.shift();
    pad.dataset.audio = item.defaultSrc;
    padAudios.set(pad,item.audio);
  });
}
let padsHidden = false; // tracks if pads are hidden

// CATEGORY BUTTONS
const categoryButtons = document.querySelectorAll('.category-bar button');

categoryButtons.forEach(btn => {
  btn.addEventListener('click', () => {
    // Remove active class
    categoryButtons.forEach(b => b.classList.remove('active'));
    btn.classList.add('active');

    currentCategory = btn.dataset.category;

    // Clear music bar
    musicBar.innerHTML = '';

    if (padsHidden) {
      // Pads are hidden ‚Üí show normal + hidden buttons
      (categoryAudios[currentCategory] || []).forEach((item, index) => createMusicButton(item, index));
      (hiddenCategoryAudios[currentCategory] || []).forEach((item, index) =>
        createMusicButton(item, index + (categoryAudios[currentCategory]?.length || 0))
      );
    } else {
      // Pads visible ‚Üí show normal buttons only
      (categoryAudios[currentCategory] || []).forEach((item, index) => createMusicButton(item, index));
    }

    // Update pad audios to match the category
    assignPadsToCategory(currentCategory);
  });
});

// set default active category
document.querySelector('[data-category="specialPads"]').classList.add('active');

// LONG MUSIC
const longMusicButton = document.getElementById('longMusic');
const longMusicAudio = new Audio('sounds/featured.mp3');
longMusicAudio.loop=true;
const volumeSlider = document.getElementById('volumeControl');
volumeSlider.addEventListener('input', ()=>{ longMusicAudio.volume = volumeSlider.value; });

longMusicButton.addEventListener('click', ()=>{
  if(longMusicAudio.paused){
    longMusicAudio.play();
    longMusicButton.classList.add('active');
    longMusicButton.classList.add('flash');
    setTimeout(()=>longMusicButton.classList.remove('flash'),150);
  } else {
    longMusicAudio.pause();
    longMusicButton.classList.remove('active');
  }
});

longMusicButton.addEventListener('dblclick', ()=>{
  uploadInput.value = ""; // üî• FIX
  uploadInput.click();

  uploadInput.onchange = ()=>{
    const file = uploadInput.files[0];
    if(file){
      longMusicAudio.src = URL.createObjectURL(file);
      longMusicButton.querySelector('.title').textContent = file.name;
      longMusicAudio.loop = true;
    }
  };
});

// CONTROLS
document.getElementById('clearPads').addEventListener('click', () => {

  // clear pads
  pads.forEach(p => {
    p.classList.remove('active');
    const a = padAudios.get(p);
    a.pause();
    a.currentTime = 0;
  });

  // clear normal + hidden music
  const allMusic = [
    ...Object.values(categoryAudios).flat(),
    ...Object.values(hiddenCategoryAudios).flat()
  ];

  allMusic.forEach(item => {
    item.audio.pause();
    item.audio.currentTime = 0;
    item.button?.classList.remove('active');
  });

  // clear long music
  longMusicAudio.pause();
  longMusicButton.classList.remove('active');
});


document.getElementById('reloadPads').addEventListener('click', () => {

  // reload normal music
  (categoryAudios[currentCategory] || []).forEach(item => {
    item.audio.src = item.defaultSrc;
    item.title = item.defaultTitle;
    item.audio.pause();
    item.audio.currentTime = 0;
    item.button?.classList.remove('active');
    if (item.button) {
  const inner = item.button.querySelector('.inner-title');
  if (inner) {
    inner.textContent = item.defaultTitle;

    // Recalculate scroll animation
    requestAnimationFrame(() => {
      if(inner.scrollWidth <= inner.parentElement.clientWidth){
        inner.style.animation = 'none';
      } else {
        inner.style.animation = 'scrollTitle 6s linear infinite';
      }
    });
  }
}

  });

  // reload hidden music
  (hiddenCategoryAudios[currentCategory] || []).forEach(item => {
    item.audio.src = item.defaultSrc;
    item.title = item.defaultTitle;
    item.audio.pause();
    item.audio.currentTime = 0;
    item.button?.classList.remove('active');
    if (item.button) {
  const inner = item.button.querySelector('.inner-title');
  if (inner) {
    inner.textContent = item.defaultTitle;

    // Recalculate scroll animation
    requestAnimationFrame(() => {
      if(inner.scrollWidth <= inner.parentElement.clientWidth){
        inner.style.animation = 'none';
      } else {
        inner.style.animation = 'scrollTitle 6s linear infinite';
      }
    });
  }
}

  });



  longMusicAudio.src='sounds/featured.mp3';
  longMusicButton.querySelector('.title').textContent='Background Music';
  longMusicButton.classList.remove('active');
});

const togglePadsBtn = document.getElementById('togglePads');
const padGrid = document.getElementById('padGrid');

togglePadsBtn.addEventListener('click', () => {
  padsHidden = !padsHidden; // toggle state

  if (padsHidden) {
    // HIDE PADS
    padGrid.style.display = 'none';
    togglePadsBtn.textContent = 'Unhide Pads';

    // Clear music bar
    musicBar.innerHTML = '';

    // Add normal music buttons
    categoryAudios[currentCategory].forEach((item,index) => createMusicButton(item,index));

    // Add hidden buttons (fully functional)
    (hiddenCategoryAudios[currentCategory] || []).forEach((item,index) => 
      createMusicButton(item,index + categoryAudios[currentCategory].length)
    );

  } else {
    // SHOW PADS
    padGrid.style.display = 'grid';
    togglePadsBtn.textContent = 'Hide Pads';

    // Reload only normal music buttons
    loadMusicButtons(currentCategory);
  }
});

function createMusicButton(item, index){
  const btn = document.createElement('button');
  btn.className = `color${(index % 6) + 1}`;
  item.button = btn;

  // Title wrapper
  const titleSpan = document.createElement('span');
  titleSpan.className = 'title';

  const inner = document.createElement('span');
  inner.className = 'inner-title';
  inner.textContent = item.title;

  titleSpan.appendChild(inner);
  btn.appendChild(titleSpan);

  // Check if text overflows ‚Üí scroll if needed
  requestAnimationFrame(() => {
    if(inner.offsetWidth <= titleSpan.offsetWidth){
      inner.style.animation = 'none'; // no scroll
    } else {
      inner.style.animation = 'scrollTitle 6s linear infinite';
    }
  });

  // CLICK PLAY / PAUSE
  btn.addEventListener('click', () => {
    const allAudios = [...categoryAudios[currentCategory], ...(hiddenCategoryAudios[currentCategory] || [])];
    allAudios.forEach(a => {
      if (a.audio !== item.audio) {
        a.audio.pause();
        a.button?.classList.remove('active');
      }
    });

    if (item.audio.paused) {
      item.audio.play();
      btn.classList.add('active');
    } else {
      item.audio.pause();
      btn.classList.remove('active');
    }

    btn.classList.add('flash');
    setTimeout(()=>btn.classList.remove('flash'),150);
  });

  // DOUBLE-CLICK UPLOAD
  btn.addEventListener('dblclick', () => {
    uploadInput.value = "";
    uploadInput.click();

    uploadInput.onchange = () => {
      const file = uploadInput.files[0];
      if(file){
        item.audio.src = URL.createObjectURL(file);
        item.title = file.name;
        inner.textContent = file.name;
   }
    };
  });

        // Recalculate scroll for new title
        requestAnimationFrame(() => {
          if(inner.offsetWidth <= titleSpan.offsetWidth){
            inner.style.animation = 'none';
          } else {
            inner.style.animation = 'scrollTitle 6s linear infinite';
          }
        });

  musicBar.appendChild(btn);
}

const hiddenCategoryAudios = {};
Object.keys(hiddenMusicData).forEach(cat => {
  hiddenCategoryAudios[cat] = hiddenMusicData[cat].map(item => ({
    name: item.file,
    defaultSrc: `sounds/${item.file}.mp3`,
    defaultTitle: item.title,
    audio: new Audio(`sounds/${item.file}.mp3`),
    button: null,
    title: item.title
  }));
});


// SERVICE WORKER
if("serviceWorker" in navigator){
  window.addEventListener("load",()=>{navigator.serviceWorker.register("service-worker.js");});
}

// INITIAL LOAD
loadMusicButtons(currentCategory);
assignPadsToCategory(currentCategory);
window.addEventListener("load", ()=>{ setTimeout(()=>{ document.getElementById("splash").style.display="none"; },1000);
});
</script> 
</body> 
</html>
